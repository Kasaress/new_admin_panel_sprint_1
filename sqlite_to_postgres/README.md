# Проектное задание: перенос данных

Вооружитесь библиотеками psycopg2 и sqlite3, чтобы создать скрипт для миграции данных в новую базу.

Критерии готовности:

- После применения скрипта все фильмы, персоны и жанры появляются в PostgreSQL.  
- Все связи между записями сохранены. 
- В коде используются `dataclass`.
- Данные загружаются пачками по n записей.
- Повторный запуск скрипта не создаёт дублирующиеся записи.
- В коде есть обработка ошибок записи и чтения.

## Особенности реализации ETL 

Входная точка скрипта - функция load_from_sqlite в файле load_data.py.
Функция принимает соединения с обеими базами. Перебирает таблицы для загрузки из константы MAPPING_TABLE_DATACLASS.
Для каждой таблицы запрашивает в исходной БД количество строк и начинает обработку данных чанками.


### Extract

Извлечение данных происходит с помощью класса SQLiteExtractor. Метод extract_data принимает номера строк, которые
нужно выгрузить.


### Transform

Неявный этап в текущей реализации. Логика трансформации данных содержится в датаклассах - в них переименовываются или 
исключаются поля объектов.


### Load

Сохранение данных осуществляется с помощью класса PostgresSaver. 
Метод save_all_data принимает данные и название таблицы, пытается вставить сразу все данные.
В случает ошибки в чанке метод вызывает статик метод класса save_single_data для сохранения данных по одной строчке.
В случае ошибки сохранения, выводит всю строчку в консоль.


### Информационные сообщения

Скрипт выводит в консоль подробную информацию о своей работе. При необходимости легко заменить принты на логгер.
Пример аутпута в консоль:

```ini
Старт копирования данных из таблицы genre.
Таблица genre содержит 26 строк.
Старт выгрузки данных с 0 по 10 строки из 26 строк из таблицы genre.
Данные получены из SQLite: таблица genre, строки с 0 по 10
Старт сохранения данных с 0 по 10 строки из 26 строк из таблицы genre.
Старт загрузки данных в таблицу genre.
10 из 10 строк вставлено в таблицу genre
Старт выгрузки данных с 10 по 20 строки из 26 строк из таблицы genre.
...
Финиш копирования данных из таблицы genre.
Старт копирования данных из таблицы person.
Таблица person содержит 4166 строк.
Старт выгрузки данных с 0 по 10 строки из 4166 строк из таблицы person.
...
Финиш копирования данных из таблицы person.
Все данные из всех таблиц обработаны.
```

