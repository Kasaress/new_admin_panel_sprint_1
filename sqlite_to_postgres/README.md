# Проектное задание: перенос данных

Вооружитесь библиотеками psycopg2 и sqlite3, чтобы создать скрипт для миграции данных в новую базу.

Критерии готовности:

- После применения скрипта все фильмы, персоны и жанры появляются в PostgreSQL.  
- Все связи между записями сохранены. 
- В коде используются `dataclass`.
- Данные загружаются пачками по n записей.
- Повторный запуск скрипта не создаёт дублирующиеся записи.
- В коде есть обработка ошибок записи и чтения.

## Особенности реализации ETL 

Входная точка скрипта - функция load_from_sqlite в файле load_data.py.
Функция принимает соединения с обеими базами. Перебирает таблицы для загрузки из константы MAPPING_TABLE_DATACLASS.
Для каждой таблицы запрашивает в исходной БД количество строк и начинает обработку данных чанками.


### Extract

Извлечение данных происходит с помощью класса SQLiteExtractor. Метод extract_data принимает номера строк, которые
нужно выгрузить.


### Transform

Неявный этап в текущей реализации. Логика трансформации данных содержится в датаклассах - в них переименовываются или 
исключаются поля объектов.


### Load

Сохранение данных осуществляется с помощью класса PostgresSaver. 
Метод save_all_data принимает данные и название таблицы, пытается вставить сразу все данные.
В случает ошибки в чанке метод вызывает статик метод класса save_single_data для сохранения данных по одной строчке.
В случае ошибки сохранения, выводит всю строчку в консоль.

